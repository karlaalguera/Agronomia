<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular Agronomía UCR</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f9f4;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c6e49;
    }
    .summary {
      text-align: center;
      font-size: 1.2em;
      margin-bottom: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .column {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 15px;
    }
    .column h2 {
      font-size: 1.1em;
      margin-bottom: 10px;
      color: #387d7a;
    }
    .course {
      padding: 10px;
      margin: 5px 0;
      border-radius: 8px;
      background-color: #e2f0cb;
      cursor: pointer;
      position: relative;
      transition: background-color 0.2s;
    }
    .course.locked {
      background-color: #f8d7da;
      cursor: not-allowed;
    }
    .course.completed {
      background-color: #a8dadc;
      text-decoration: line-through;
    }
    .tooltip {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 5px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .course.locked:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular Agronomía - UCR</h1>
  <div class="summary" id="creditos">Créditos aprobados: 0 / 179</div>
  <div class="grid" id="malla"></div>

  <script>
    const cursos = {
      "1-I": [
        ["B0106", "Biología General", [], 3],
        ["B0107", "Laboratorio de Biología General", [], 1],
        ["EF", "Actividad Deportiva", [], 0],
        ["EG-I", "Humanidades I", [], 6],
        ["MA1210", "Cálculo I", [], 3],
        ["QU0114", "Química General Intensiva", [], 4],
        ["QU0115", "Lab. Química General Intensiva", [], 1]
      ],
      "1-II": [
        ["B0111", "Botánica Agrícola I", ["B0106", "B0107"], 4],
        ["EG-II", "Humanidades II", ["EG-I"], 6],
        ["QU0200", "Química Analítica Cuantitativa I", ["QU0114"], 3],
        ["QU0201", "Lab. Química Analítica Cuantitativa I", ["QU0115"], 2],
        ["QU0210", "Fundamentos de Química Orgánica", ["QU0114"], 4],
        ["QU0211", "Lab. Fundamentos de Química Orgánica", ["QU0115"], 1]
      ],
      "1-III": [
        ["AF0104", "Métodos de investigación Agrícola", ["MA1210"], 4],
        ["AF0106", "Práctica Agrícola I", ["B0111"], 2]
      ]
      // Continúa agregando todos los demás cursos como en la estructura...
    };

    const progreso = JSON.parse(localStorage.getItem("progresoAgronomia") || '{}');

    function puedeAprobar(requisitos) {
      return requisitos.every(id => progreso[id]);
    }

    function guardarProgreso() {
      localStorage.setItem("progresoAgronomia", JSON.stringify(progreso));
    }

    function calcularCreditos() {
      let total = 0;
      for (const ciclo in cursos) {
        cursos[ciclo].forEach(([codigo, _, __, creditos]) => {
          if (progreso[codigo]) total += creditos;
        });
      }
      document.getElementById("creditos").textContent = `Créditos aprobados: ${total} / 179`;
    }

    function renderMalla() {
      const grid = document.getElementById("malla");
      grid.innerHTML = "";
      for (const ciclo in cursos) {
        const col = document.createElement("div");
        col.className = "column";
        const h2 = document.createElement("h2");
        h2.textContent = ciclo;
        col.appendChild(h2);

        cursos[ciclo].forEach(([codigo, nombre, reqs, creditos]) => {
          const div = document.createElement("div");
          div.className = "course";

          if (!puedeAprobar(reqs)) {
            div.classList.add("locked");
            const tip = document.createElement("div");
            tip.className = "tooltip";
            tip.textContent = "Requiere: " + reqs.join(", ");
            div.appendChild(tip);
          }

          if (progreso[codigo]) div.classList.add("completed");

          div.textContent = `${codigo} - ${nombre}`;

          div.addEventListener("click", () => {
            if (div.classList.contains("locked")) return;
            progreso[codigo] = !progreso[codigo];
            guardarProgreso();
            renderMalla();
            calcularCreditos();
          });

          col.appendChild(div);
        });

        grid.appendChild(col);
      }
      calcularCreditos();
    }

    renderMalla();
  </script>
</body>
</html>
