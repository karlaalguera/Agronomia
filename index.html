<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular Agronomía UCR</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f9f4;
      margin: 0;
      padding: 20px;
      color: #333;
    }
    h1 {
      text-align: center;
      color: #2c6e49;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }
    .column {
      background-color: #ffffff;
      border-radius: 12px;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
      padding: 15px;
    }
    .column h2 {
      font-size: 1.1em;
      margin-bottom: 10px;
      color: #387d7a;
    }
    .course {
      padding: 10px;
      margin: 5px 0;
      border-radius: 8px;
      background-color: #e2f0cb;
      cursor: pointer;
      position: relative;
      transition: background-color 0.2s;
    }
    .course.locked {
      background-color: #f8d7da;
      cursor: not-allowed;
    }
    .course.completed {
      background-color: #a8dadc;
      text-decoration: line-through;
    }
    .tooltip {
      visibility: hidden;
      background-color: #333;
      color: #fff;
      text-align: center;
      border-radius: 5px;
      padding: 5px;
      position: absolute;
      z-index: 1;
      bottom: 100%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      transition: opacity 0.3s;
    }
    .course.locked:hover .tooltip {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular Agronomía - UCR</h1>
  <div class="grid" id="malla"></div>

  <script>
    const cursos = {
      "1-I": [
        ["B0106", "Biología General", []],
        ["B0107", "Lab. Biología General", []],
        ["EF", "Actividad Deportiva", []],
        ["EG-I", "Humanidades I", []],
        ["MA1210", "Cálculo I", []],
        ["QU0114", "Química General Intensiva", []],
        ["QU0115", "Lab. Química General", []]
      ],
      "1-II": [
        ["B0111", "Botánica Agrícola I", ["B0106", "B0107"]],
        ["EG-II", "Humanidades II", ["EG-I"]],
        ["QU0200", "Química Analítica Cuantitativa I", ["QU0114"]],
        ["QU0201", "Lab. Química Analítica Cuantitativa I", ["QU0115"]],
        ["QU0210", "Fundamentos de Química Orgánica", ["QU0114"]],
        ["QU0211", "Lab. Fund. Química Orgánica", ["QU0115"]]
      ],
      "1-III": [
        ["AF0104", "Métodos de investigación Agrícola", ["MA1210"]],
        ["AF0106", "Práctica Agrícola I", ["B0111"]]
      ],
      "2-IV": [
        ["EG-ARTE", "Curso de Arte", []],
        ["AF0105", "Fisiología vegetal", ["AF0104", "QU0201", "QU0210", "QU0211"]],
        ["AF0107", "Fitogenética", ["AF0104", "QU0210", "QU0211"]],
        ["AF0206", "Relación suelo-planta", ["AF0104", "QU0200"]],
        ["FS0103", "Física para Ciencias de la Vida I", []]
      ],
      "2-V": [
        ["AF0111", "Biología de Malezas", ["AF0105", "AF0107"]],
        ["AF0109", "Fitopatología", ["AF0105", "AF0107"]],
        ["AF0110", "Entomología Agrícola", ["AF0105", "AF0107"]],
        ["AF0108", "Agroecología", ["AF0105", "AF0107", "AF0206"]],
        ["AF0112", "Productividad de suelos", ["AF0105", "AF0206"]]
      ],
      "2-VI": [
        ["AF0113", "Práctica Agrícola II", ["AF0111", "AF0109", "AF0110", "AF0108"]],
        ["AF0114", "Elementos de Economía Agrícola", ["AF0108"]]
      ],
      "3-VII": [
        ["SR-I", "Seminario Realidad Nacional I", ["EG-II"]],
        ["AF3410", "Fisiología de los Cultivos", ["AF0113"]],
        ["AF0118", "Manejo Integrado de problemas fitosanitarios", ["AF0113"]],
        ["AF0119", "Conservación de Suelos", ["AF0112"]],
        ["AF0116", "Manejo de Aguas Agrícolas", ["FS0103", "AF0112"]],
        ["AF0201", "Gestión y Administración de Empresas Agrícolas", ["AF0114"]]
      ],
      "3-VIII": [
        ["SR-II", "Seminario Realidad Nacional II", ["SR-I"]],
        ["OPT951-A", "Optativo Bach./Lic. A", []],
        ["AF0117", "Sistemas de Producción de Cultivos", ["AF3410", "AF0118", "AF0201"]],
        ["AF0115", "Equipos Agrícolas y Mecanización", ["AF0119", "AF0116"]],
        ["AF0202", "Práctica Agrícola III", ["AF0118", "AF0201"]]
      ],
      "4-IX": [
        ["RP", "Repertorio", []],
        ["AF0212", "Diseño de Experimentos I", ["AF0117"]],
        ["AF0206", "Proyecto Productivo", ["AF0117", "AF0202"]],
        ["OPT951-B", "Optativo Bach./Lic. B", []]
      ],
      "4-X": [
        ["AF0220", "Taller de Formulación de Proyectos", ["AF0212"]],
        ["AF0207", "Pasantía", ["AF0206"]]
      ],
      "5-XI": [
        ["AF0221", "Taller de Investigación I", ["AF0220", "AF0207"]],
        ["OPT951-C", "Optativo Bach./Lic. C", []]
      ],
      "5-XII": [
        ["AF0222", "Taller de Investigación II", ["AF0221"]],
        ["AF5413", "Seminario de Agronomía", ["AF0207"]],
        ["OPT951-D", "Optativo Bach./Lic. D", []]
      ],
      "5-XIII": [
        ["AF9500", "Investigación Dirigida 1", []],
        ["AF9600", "Seminario de Graduación 1", ["AF9500"]],
        ["AF9601", "Seminario de Graduación 2", []],
        ["AF9602", "Seminario de Graduación 3", []],
        ["AF9700", "Práctica Dirigida I", []],
        ["AF9701", "Práctica Dirigida II", ["AF9700"]],
        ["AF9702", "Práctica Dirigida III", ["AF9701"]]
      ],
      "5-XIV": [
        ["AF9501", "Investigación Dirigida 2", ["AF9500"]]
      ]
    };

    const progreso = JSON.parse(localStorage.getItem("progresoAgronomia") || '{}');

    function puedeAprobar(requisitos) {
      return requisitos.every(id => progreso[id]);
    }

    function guardarProgreso() {
      localStorage.setItem("progresoAgronomia", JSON.stringify(progreso));
    }

    function renderMalla() {
      const grid = document.getElementById("malla");
      grid.innerHTML = "";
      for (const ciclo in cursos) {
        const col = document.createElement("div");
        col.className = "column";
        const h2 = document.createElement("h2");
        h2.textContent = ciclo;
        col.appendChild(h2);

        cursos[ciclo].forEach(([codigo, nombre, reqs]) => {
          const div = document.createElement("div");
          div.className = "course";

          if (!puedeAprobar(reqs)) {
            div.classList.add("locked");
            const tip = document.createElement("div");
            tip.className = "tooltip";
            tip.textContent = "Requiere: " + reqs.join(", ");
            div.appendChild(tip);
          }

          if (progreso[codigo]) div.classList.add("completed");

          div.textContent = `${codigo} - ${nombre}`;

          div.addEventListener("click", () => {
            if (div.classList.contains("locked")) return;
            progreso[codigo] = !progreso[codigo];
            guardarProgreso();
            renderMalla();
          });

          col.appendChild(div);
        });

        grid.appendChild(col);
      }
    }

    renderMalla();
  </script>
</body>
</html>
